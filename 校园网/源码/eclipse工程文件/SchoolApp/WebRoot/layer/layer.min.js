/**************************************************************

 @Name : layer v1.4.1 弹层组件压缩版
 @author: 贤心
 @date: 2012-9-15
 @blog: http://xu.sentsin.com
 @微博：http://t.qq.com/xian_xin
 @QQ群：176047036(前端超级群,js面向对象) 176047238(layer弹层组件群1)
 @Copyright: Sentsin Xu(贤心)
 @官网说明：http://xu.sentsin.com/jquery/layer
 @赞助layer: https://me.alipay.com/sentsin
		
 *************************************************************/ 

void function(c,f){
	var e=true, //是否采用自动获取绝对路径。 false：将采用相对路径，需配置g
	g="", //相对路径url
	b={getPath:function(){var i=document.scripts,h=i[i.length-1].src;return h.substring(0,h.lastIndexOf("/")+1)},append:function(){e&&(g=this.getPath());var h='<!--[if IE 6]><script type="text/javascript" src="'+g+'skin/png.js"><\/script><![endif]-->';$("head").prepend('\n<link rel="stylesheet" type="text/css" href="'+g+'skin/layer.css"  />');document.write(h)},global:{iE6:!-[1,]&&!c.XMLHttpRequest,times:0,config:{}}};b.append();var a=Function();a.prototype={v:"1.4.1",alert:function(i,j,k,h){return $.layer({dialog:{msg:i,type:j,yes:h},title:k})},confirm:function(i,h,j,k){return $.layer({dialog:{msg:i,type:4,btns:2,yes:h,no:k},title:j})},msg:function(j,i,h,k){(j==""||j==f)&&(j="&nbsp;");(i==f||i=="")&&(i=2);return $.layer({dialog:{msg:j,type:h,maxWidth:k},time:i,title:["",false],closeBtn:["",false]})},tips:function(i,h,k,j){return $.layer({type:4,shade:false,time:k,maxWidth:j,tips:{msg:i,follow:h}})},load:function(i,k,h){var j=true;k==3&&(j=false);return $.layer({time:i,shade:h,loading:{type:k},border:[10,0.3,"#000",j],type:3,title:["",false],closeBtn:[0,false]})}};layer=new a();var d=function(h){this.init(h)};d.prototype={type:function(){return["dialog","page","iframe","loading","tips"]},config:{skin:0,shade:[0.5,"#000",true],fix:true,move:[".xubox_title",true],type:0,title:["信息",true],offset:["220px","50%"],area:["310px","auto"],closeBtn:[0,true],time:0,border:[10,0.3,"#000",true],zIndex:19891014,maxWidth:400,fadeIn:[300,false],dialog:{btns:1,btn:["确定","取消"],type:3,msg:"",yes:function(h){LAYER.close(h)},no:function(h){LAYER.close(h)}},page:{dom:"#xulayer"},iframe:{src:"http://xu.sentsin.com"},loading:{type:0},tips:{msg:"",follow:""},success:function(h){},close:function(h){LAYER.close(h)},end:function(){}},init:function(i){b.global.times++;var h=this.config;this.config=$.extend({},h,i);this.dialog=$.extend({},h.dialog,i.dialog);this.page=$.extend({},h.page,i.page);this.iframe=$.extend({},h.iframe,i.iframe);this.loading=$.extend({},h.loading,i.loading);this.tips=$.extend({},h.tips,i.tips);this.adjust()},space:function(){b.global.config[b.global.times]=this.config;var j=this.config,m=this.dialog,i=['<div class="xubox_dialog"><span class="xubox_msg xulayer_png32 xubox_msgico xubox_msgtype'+m.type+'"></span><span class="xubox_msg xubox_text">'+m.msg+"</span></div>",'<div class="xubox_page xubox_page_'+j.skin+'"></div>','<iframe id="xubox_iframe" name="xubox_iframe" class="xubox_iframe" frameborder="0" src="'+this.iframe.src+'"></iframe>','<span class="xubox_loading xubox_loading_'+this.loading.type+'"></span>','<div class="xubox_tips xubox_tips_'+j.skin+'"><div class="xubox_tipsMsg">'+this.tips.msg+'</div><i class="xulayer_png32"></i></div>'];var o="",k="",h=b.global.times;this.zIndex=j.zIndex+h;var n=this.zIndex,p="z-index:"+n+"; background:"+j.shade[1]+"; opacity:"+j.shade[0]+"; filter:'alpha(opacity="+j.shade[0]*100+")'; filter:alpha(opacity="+j.shade[0]*100+");";j.shade[2]&&(o='<div id="xubox_shade'+h+'" class="xubox_shade xubox_shade_'+j.skin+'" style="'+p+'"></div>');var q="z-index:"+(n-1)+";  background: "+j.border[2]+"; opacity:"+j.border[1]+"; filter:'alpha(opacity="+j.border[1]*100+")'; filter:alpha(opacity="+j.border[1]*100+"); top:-"+j.border[0]+"px; left:-"+j.border[0]+"px;";j.border[3]&&(k='<div id="xubox_border'+h+'" class="xubox_border" style="'+q+'"></div>');var l='<div times="'+h+'" showtime="'+j.time+'" style="z-index:'+n+'" id="xubox_layer'+h+'" class="xubox_layer xubox_layer_'+j.skin+'"><div style="z-index:'+n+'" class="xubox_main xubox_main_'+j.skin+'">'+i[j.type]+'<h2 class="xubox_title xubox_title_'+j.skin+'"><i class="xulayer_png32"></i><em>'+j.title[0]+'</em></h2><a class="xubox_close xulayer_png32 xubox_close'+j.closeBtn[0]+"_"+j.skin+'" href="javascript:;"></a><span class="xubox_botton"></span></div>'+k+"</div>";return[o,l]},adjust:function(){var i=this,h="",j=this.config,n=this.dialog,m=this.page,l=function(){h=i.space();$("body").append(h[0])};switch(j.type){case 1:if($(m.dom).parents(".xubox_page").length==0){l();$(m.dom).show().wrap(h[1])}else{return false}break;case 2:$(".xubox_layer").find(".xubox_iframe").length>0&&LAYER.close($(".xubox_iframe").parents(".xubox_layer").attr("times"));l();$("body").append(h[1]);break;case 3:j.title=["",false];j.area=["auto","auto"];j.closeBtn=["",false];$(".xubox_layer").find(".xubox_loading").length>0&&LAYER.close($(".xubox_loading").parents(".xubox_layer").attr("times"));l();$("body").append(h[1]);break;case 4:j.title=["",false];j.area=["auto","auto"];j.fix=false;j.border=[0,0,0,false];$(".xubox_layer").find(".xubox_tips").length>0&&LAYER.close($(".xubox_tips").parents(".xubox_layer").attr("times"));l();$("body").append(h[1]);$(".xubox_tips").fadeIn(200).parents(".xubox_layer").find(".xubox_close").css({top:5,right:5});break;default:j.title[1]||(j.area=["auto","auto"]);$(".xubox_layer").find(".xubox_dialog").length>0&&LAYER.close($(".xubox_dialog").parents(".xubox_layer").attr("times"));l();$("body").append(h[1]);break}times=b.global.times;this.layerS=$("#xubox_shade"+times);this.layerB=$("#xubox_border"+times);this.layerE=$("#xubox_layer"+times);var k=this.layerE;var o=k.outerWidth()/2;if(j.offset[1].indexOf("px")!=-1){var p=o+parseInt(j.offset[1])}else{if(j.offset[1]=="50%"){var p=j.offset[1]}else{var p=o+parseInt(j.offset[1])/200*$(c).width()}}k.css({left:p+j.border[0],width:j.area[0],height:j.area[1]});j.fix?k.css({top:j.offset[0]}):k.css({top:parseInt(j.offset[0])+$(c).scrollTop(),position:"absolute"});this.layerMian=k.find(".xubox_main");this.layerTitle=k.find(".xubox_title");this.layerText=k.find(".xubox_text");this.layerPage=k.find(".xubox_page");this.layerBtn=k.find(".xubox_botton");if(j.type==0&&j.title[1]){switch(n.btns){case 0:this.layerBtn.html("").hide();break;case 2:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton2_'+j.skin+'">'+n.btn[0]+'</a><a href="javascript:;" class="xubox_no xubox_botton3_'+j.skin+'">'+n.btn[1]+"</a>");break;default:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton1_'+j.skin+'">'+n.btn[0]+'</a><a class="xubox_no" style="displa:none;"></a>')}}this.pagetype();this.callback(j)},pagetype:function(){var h=this,k=this.layerE,i=this.config,n=this.page;h.autoArea();i.time==0||this.autoclose();i.move[1]?k.find(".xubox_title").css({cursor:"move"}):k.find(".xubox_title").css({cursor:"auto"});i.closeBtn[1]||k.find(".xubox_close").remove().hide();if(!i.title[1]){k.find(".xubox_title").remove().hide();i.type!=4&&k.find(".xubox_close").removeClass("xubox_close0_"+i.skin).addClass("xubox_close1_"+i.skin)}else{this.layerTitle.css({width:k.outerWidth()})}i.border||k.removeClass("xubox_layerBoder");var l=parseInt(this.layerMian.css("margin-right")),m=parseInt(k.css("padding-bottom"));k.attr({type:h.type()[i.type]});switch(i.type){case 1:k.find(n.dom).addClass("layer_pageContent");this.layerPage.css({width:k.width()-2*l});i.shade&&k.css({"z-index":h.zIndex+1});i.title[1]?this.layerPage.css({top:l+this.layerTitle.outerHeight()}):this.layerPage.css({top:l});break;case 2:k.find(".xubox_iframe").addClass("xubox_load").css({width:k.width()-2*l});i.title[1]?k.find(".xubox_iframe").css({top:this.layerTitle.height()+m,height:k.height()-this.layerTitle.height()}):k.find(".xubox_iframe").css({top:m,height:k.height()});b.global.iE6&&k.find("#xubox_iframe").attr("src",h.iframe.src);break;case 4:var o=$(h.tips.follow).offset().top-$(h.tips.follow).outerHeight()-k.outerHeight()+15;var j=$(h.tips.follow).offset().left+k.outerWidth()/2;k.css({top:o,left:j});break;default:if(i.title[1]){this.layerText.css({paddingTop:18+this.layerTitle.outerHeight()})}else{k.find(".xubox_msgico").css({top:"10px"});this.layerText.css({marginTop:12})}break}var p=0;i.fadeIn[1]&&(p=i.fadeIn[0]);k.animate({opacity:1,filter:"alpha(opacity="+100+")"},p);this.move()},autoArea:function(){var l=this,n=this.layerE,i=this.config,k=this.page;if(i.area[0]=="auto"&&this.layerMian.outerWidth()>=i.maxWidth){n.css({width:i.maxWidth})}i.title[1]?titHeight=n.find(".xubox_title").innerHeight():titHeight=0;switch(i.type){case 0:var j=this.layerBtn.find("a"),m=this.layerText.outerHeight()+20;if(j.length>0){var h=this.layerBtn.find("a").outerHeight()+parseInt(this.layerBtn.find("a").css("bottom"))+10}else{var h=0}break;case 1:var h=0,m=$(k.dom).outerHeight();n.css({width:this.layerPage.outerWidth()});break;case 3:var h=0;var m=$(".xubox_loading").outerHeight();this.layerMian.css({width:$(".xubox_loading").width()});break}n.css({marginLeft:-n.outerWidth()/2});i.area[1]=="auto"&&this.layerMian.css({height:titHeight+m+h});l.layerB.css({width:n.outerWidth()+2*i.border[0],height:n.outerHeight()+2*i.border[0]});(b.global.iE6&&i.area[0]!="auto")&&this.layerMian.css({width:n.outerWidth()})},move:function(){var i=this.config,h=this.layerE.find(i.move[0]);i.move[1]&&h.attr("move","ok");$(i.move[0]).mousedown(function(n){n.preventDefault();var m=$(this).parents(".xubox_layer");if($(this).attr("move")==="ok"){var k=true,l=n.pageX-parseInt(m.position().left),j=n.pageY-parseInt(m.position().top);$(document).mousemove(function(q){if(k){var o=q.pageX-l;if(m.css("position")=="fixed"){var p=q.pageY-j-$(c).scrollTop()}else{var p=q.pageY-j}m.css({left:o,top:p})}}).mouseup(function(){k=false})}})},getIndex:function(h){return $(h).parents(".xubox_layer").attr("times")},getChildFrame:function(h){return $("#xubox_iframe").contents().find(h)},getFrameIndex:function(){return $("#xubox_iframe").parents(".xubox_layer").attr("times")},close:function(j){var l=$("#xubox_layer"+j),h=$("#xubox_shade"+j);if(l.attr("type")==this.type()[1]){l.find(".xubox_close,.xubox_botton,.xubox_title,.xubox_border").remove();for(var k=0;k<3;k++){l.find(".layer_pageContent").unwrap().hide()}}else{$.browser.msie&&l.find("#xubox_iframe").remove();l.remove()}h.remove();try{b.global.iE6&&this.reselect();b.global.config[j].end();b.global.times--;delete b.global.config[j]}catch(m){}},loadClose:function(){var i=$(".xubox_loading").parents(".xubox_layer"),h=i.attr("times");$("#xubox_shade"+h).remove();i.remove()},autoclose:function(){$.each(b.global.config,function(i,k){var l=k.time;var h=function(){l--;l===0&&LAYER.close(i);$(".xubox_layer").length<1&&clearInterval(j)};var j=setInterval(h,1000)})},shift:function(k,j){var l=this,h=this.config,i=b.global.iE6,m=this.layerE;switch(k){case"left-top":m.css({left:m.outerWidth()/2+h.border[0],top:-m.outerHeight()}).animate({top:h.border[0]},j,function(){i&&l.IE6()});break;case"right-top":m.css({left:$(c).width()-m.outerWidth()/2-h.border[0],top:-m.outerHeight()}).animate({top:h.border[0]},j,function(){i&&l.IE6()});break;case"left-bottom":m.css({left:m.outerWidth()/2+h.border[0],top:$(c).height()}).animate({top:$(c).height()-m.outerHeight()-h.border[0]},j,function(){i&&l.IE6()});break;case"right-bottom":m.css({left:$(c).width()-m.outerWidth()/2-h.border[0],top:$(c).height()}).animate({top:$(c).height()-m.outerHeight()-h.border[0]},j,function(){i&&l.IE6()});break}},callback:function(k){LAYER=this;var j=this.layerE,h=this.config,i=this.dialog;this.config.success(j);b.global.iE6&&this.IE6();$(".xubox_close").off("click").on("click",function(){var l=$(this).parents(".xubox_layer").attr("times");try{b.global.config[l].close(l)}catch(m){LAYER.close(l)}});j.find(".xubox_yes").off("click").on("click",function(){var l=$(this).parents(".xubox_layer").attr("times");i.yes(l)});j.find(".xubox_no").off("click").on("click",function(){var l=$(this).parents(".xubox_layer").attr("times");i.no(l)})},IE6:function(){var k=this,l=this.layerE,h=function(){var m=[$(document).width(),$(document).height(),$(c).width()];m[0]>m[1]&&(m[0]=m-17);k.layerS.css({width:m[0],height:m[1]})};h();$(c).resize(h).scroll(h);var j=l.offset().top;if(this.config.fix){var i=function(){l.css({top:$(document).scrollTop()+j})}}else{var i=function(){l.css({top:j})}}i();$(c).scroll(i);$.each($("select"),function(m,n){$(this).css("display")=="none"||$(this).attr({layer:"1"}).hide()});this.reselect=function(){$.each($("select"),function(m,n){($(this).attr("layer")==1&&$(".xubox_layer").length<1)&&$(this).removeAttr("layer").show()})};DD_belatedPNG.fix(".xulayer_png32")}};$.layer=function(h){return new d(h)}}(window);